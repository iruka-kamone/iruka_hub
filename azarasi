local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local killAura = false
local currentIsland
local anchorPart
local followConnection

local function createAnchorPart()
	if anchorPart and anchorPart.Parent then return anchorPart end
	anchorPart = Instance.new("Part")
	anchorPart.Name = "RaidAnchor"
	anchorPart.Anchored = true
	anchorPart.Transparency = 1
	anchorPart.CanCollide = false
	anchorPart.Size = Vector3.new(2, 2, 2)
	anchorPart.Parent = workspace
	anchorPart.Position =CFrame.new(hrp.Position - Vector3.new(0, 3, 0))
	return anchorPart
end

local function getHighestRaidIsland()
	local raidMap = workspace:FindFirstChild("Map") and workspace.Map:FindFirstChild("RaidMap")
	if not raidMap then return nil end

	local highestIsland, highestNum = nil, -math.huge
	for _, island in pairs(raidMap:GetChildren()) do
		local num = tonumber(island.Name:match("RaidIsland(%d+)"))
		if num and num > highestNum then
			highestNum = num
			highestIsland = island
		end
	end
	return highestIsland
end

local function moveAboveIsland(island)
	if not island then return end
	local base = island:FindFirstChild("Center") or island:FindFirstChildWhichIsA("BasePart")
	if not base then return end

	local part = createAnchorPart()
	local targetPos = base.Position + Vector3.new(0, 70, 100)

	if followConnection then followConnection:Disconnect() end

	followConnection = RunService.Heartbeat:Connect(function()
		if hrp and part then
			hrp.CFrame = CFrame.new(part.Position)
		end
	end)

	local distance = (part.Position - targetPos).Magnitude
	local speed = 350
	local tweenTime = distance / speed

	local tween = TweenService:Create(part, TweenInfo.new(tweenTime, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Position = targetPos})
	tween:Play()
end


task.spawn(function()
	RunService.Heartbeat:Connect(function()
		if killAura then
			pcall(function()
				for _, v in pairs(workspace.Enemies:GetDescendants()) do
					if v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") and v.Humanoid.Health > 0 then
						repeat
							RunService.Heartbeat:Wait()
							v.Humanoid.Health = 0
							v.HumanoidRootPart.CanCollide = false
							sethiddenproperty(player, "SimulationRadius", math.huge)
						until not v.Parent or not workspace.Enemies:FindFirstChild(v.Name)
					end
				end
			end)
		end
	end)
end)

task.spawn(function()
	while task.wait(1) do
		if killAura then
			local newIsland = getHighestRaidIsland()
			if newIsland and newIsland ~= currentIsland then
				currentIsland = newIsland
				moveAboveIsland(currentIsland)
			end
		end
	end
end)

local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "KillAllGUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 230, 0, 100)
frame.Position = UDim2.new(0.3, 0, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 10)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, -40, 0, 30)
title.Position = UDim2.new(0, 10, 0, 5)
title.BackgroundTransparency = 1
title.Text = "Raid Kill Aura"
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextColor3 = Color3.new(1,1,1)
title.TextXAlignment = Enum.TextXAlignment.Left

task.spawn(function()
	while title do
		for i = 0, 1, 0.01 do
			title.TextColor3 = Color3.fromHSV(i, 1, 1)
			task.wait(0.03)
		end
	end
end)

local irukaLabel = Instance.new("TextLabel", frame)
irukaLabel.Size = UDim2.new(0, 80, 0, 20)
irukaLabel.Position = UDim2.new(1, -115, 0, 11)
irukaLabel.BackgroundTransparency = 1
irukaLabel.Text = "iruka hub"
irukaLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
irukaLabel.TextTransparency = 0.3
irukaLabel.TextSize = 14
irukaLabel.Font = Enum.Font.GothamSemibold
irukaLabel.TextXAlignment = Enum.TextXAlignment.Right

local close = Instance.new("TextButton", frame)
close.Size = UDim2.new(0, 25, 0, 25)
close.Position = UDim2.new(1, -30, 0, 5)
close.Text = "Ã—"
close.TextColor3 = Color3.fromRGB(255, 100, 100)
close.BackgroundTransparency = 1
close.TextSize = 20
close.Font = Enum.Font.GothamBold

local switch = Instance.new("TextButton", frame)
switch.Size = UDim2.new(0.9, 0, 0, 40)
switch.Position = UDim2.new(0.05, 0, 0, 45)
switch.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
switch.TextColor3 = Color3.fromRGB(255, 255, 255)
switch.Text = "OFF"
switch.Font = Enum.Font.GothamBold
switch.TextSize = 18
Instance.new("UICorner", switch).CornerRadius = UDim.new(0, 6)

switch.MouseButton1Click:Connect(function()
	killAura = not killAura
	if killAura then
		switch.Text = "ON"
		switch.BackgroundColor3 = Color3.fromRGB(0, 85, 255)
		currentIsland = getHighestRaidIsland()
		if currentIsland then
			moveAboveIsland(currentIsland)
		end
	else
		switch.Text = "OFF"
		switch.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
		if followConnection then followConnection:Disconnect() end
	end
end)

close.MouseButton1Click:Connect(function()
	killAura = false
	if followConnection then followConnection:Disconnect() end
	if anchorPart then anchorPart:Destroy() end
	gui:Destroy()
end)
